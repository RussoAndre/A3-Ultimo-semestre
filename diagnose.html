<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoTech Diagnostic</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .status {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .success { border-left: 4px solid #10B981; }
        .error { border-left: 4px solid #EF4444; }
        .warning { border-left: 4px solid #F59E0B; }
        h1 { color: #10B981; }
        pre {
            background: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        button {
            background: #10B981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px 10px 0;
        }
        button:hover {
            background: #059669;
        }
    </style>
</head>
<body>
    <h1>üîç EcoTech Diagnostic Tool</h1>
    
    <div class="status">
        <h2>Browser Information</h2>
        <pre id="browser-info"></pre>
    </div>

    <div class="status">
        <h2>Feature Detection</h2>
        <div id="features"></div>
    </div>

    <div class="status">
        <h2>Console Errors</h2>
        <div id="errors">No errors detected yet...</div>
    </div>

    <div class="status">
        <h2>Actions</h2>
        <button onclick="testLocalStorage()">Test LocalStorage</button>
        <button onclick="testFetch()">Test Network</button>
        <button onclick="clearCache()">Clear Cache</button>
        <button onclick="window.location.href='http://localhost:3000'">Go to App</button>
    </div>

    <script>
        // Display browser info
        document.getElementById('browser-info').textContent = 
            `User Agent: ${navigator.userAgent}\n` +
            `Platform: ${navigator.platform}\n` +
            `Language: ${navigator.language}\n` +
            `Online: ${navigator.onLine}\n` +
            `Cookies Enabled: ${navigator.cookieEnabled}`;

        // Feature detection
        const features = {
            'LocalStorage': typeof(Storage) !== "undefined",
            'Service Worker': 'serviceWorker' in navigator,
            'Fetch API': 'fetch' in window,
            'ES6 Modules': 'noModule' in document.createElement('script'),
            'WebCrypto': 'crypto' in window && 'subtle' in window.crypto,
            'IntersectionObserver': 'IntersectionObserver' in window,
        };

        let featuresHTML = '';
        for (const [feature, supported] of Object.entries(features)) {
            const className = supported ? 'success' : 'error';
            const icon = supported ? '‚úÖ' : '‚ùå';
            featuresHTML += `<div class="${className}">${icon} ${feature}: ${supported ? 'Supported' : 'Not Supported'}</div>`;
        }
        document.getElementById('features').innerHTML = featuresHTML;

        // Capture console errors
        const errors = [];
        const originalError = console.error;
        console.error = function(...args) {
            errors.push(args.join(' '));
            updateErrors();
            originalError.apply(console, args);
        };

        window.addEventListener('error', (event) => {
            errors.push(`Error: ${event.message} at ${event.filename}:${event.lineno}`);
            updateErrors();
        });

        window.addEventListener('unhandledrejection', (event) => {
            errors.push(`Unhandled Promise Rejection: ${event.reason}`);
            updateErrors();
        });

        function updateErrors() {
            const errorsDiv = document.getElementById('errors');
            if (errors.length === 0) {
                errorsDiv.innerHTML = 'No errors detected yet...';
                errorsDiv.className = 'success';
            } else {
                errorsDiv.innerHTML = '<pre>' + errors.join('\n\n') + '</pre>';
                errorsDiv.className = 'error';
            }
        }

        // Test functions
        function testLocalStorage() {
            try {
                localStorage.setItem('test', 'value');
                const value = localStorage.getItem('test');
                localStorage.removeItem('test');
                alert('‚úÖ LocalStorage is working! Value: ' + value);
            } catch (e) {
                alert('‚ùå LocalStorage error: ' + e.message);
            }
        }

        function testFetch() {
            fetch('http://localhost:3000')
                .then(response => {
                    alert('‚úÖ Network request successful! Status: ' + response.status);
                })
                .catch(error => {
                    alert('‚ùå Network error: ' + error.message);
                });
        }

        function clearCache() {
            if (confirm('Clear browser cache and localStorage?')) {
                localStorage.clear();
                sessionStorage.clear();
                if ('caches' in window) {
                    caches.keys().then(names => {
                        names.forEach(name => caches.delete(name));
                    });
                }
                alert('‚úÖ Cache cleared! Please refresh the page.');
            }
        }

        // Auto-check after 2 seconds
        setTimeout(() => {
            if (errors.length === 0) {
                document.getElementById('errors').innerHTML = 
                    '<div class="success">‚úÖ No errors detected! Your browser seems compatible.</div>';
            }
        }, 2000);
    </script>
</body>
</html>
